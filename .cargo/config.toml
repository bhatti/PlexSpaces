# Cargo Configuration for PlexSpaces
# Optimizes build performance and artifact sharing

[build]
# Use limited CPU cores for parallel compilation (default: 4, override with CARGO_BUILD_JOBS env var)
# Set CARGO_BUILD_JOBS=0 to use all cores, or CARGO_BUILD_JOBS=N for specific number
jobs = 4  # Default to 4 cores for better performance

# Incremental compilation for faster rebuilds (enabled by default in Cargo, but explicit here)
incremental = true

# Rustc wrapper for distributed caching (optional - uncomment if sccache is installed)
# rustc-wrapper = "sccache"

# Target directory - shared across workspace and examples
# This ensures examples can reuse workspace build artifacts
target-dir = "target"

[target.'cfg(all())']
# Optimize linker for faster builds (platform-specific)
# On Linux, use mold if available (much faster than default)
# On macOS, use zld if available
# Fallback to default if neither is available

[profile.dev]
# Faster dev builds
opt-level = 0
debug = true
incremental = true
# Disable LTO for faster compilation
lto = false
# More codegen units for parallel compilation (256 = maximum parallelism)
codegen-units = 256
# Split debuginfo for faster linking (macOS/Linux)
split-debuginfo = "packed"

[profile.test]
# Optimize test builds slightly for faster execution
opt-level = 1
debug = true
incremental = true
lto = false
codegen-units = 256
# Split debuginfo for faster linking
split-debuginfo = "packed"

# Network configuration for faster dependency downloads
[net]
retry = 2
git-fetch-with-cli = true

# Registry configuration
[registry]
default = "crates-io"

[registries.crates-io]
protocol = "sparse"
